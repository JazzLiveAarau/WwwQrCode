// File: QrCodePrint.js
// Date: 2022-05-02
// Author: Gunnar Lid√©n

// File content
// =============
//
// QR Code generation functions


// References
// https://www.studytonight.com/post/javascript-qr-code-generator
// https://cdnjs.com/libraries/qrious

// Problem not filling canvas
// https://github.com/neocotic/qrious/issues/105
// https://stackoverflow.com/questions/52825735/generate-and-download-qr-code-from-string-with-qrious-additional-white-spaces


///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// Start Global Parameters /////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

// Instance of the class QRious defined in file /QrCodeLib/qrious.js
var g_object_generate_qr_code = null;

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// End Global Parameters ///////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// Start Generate Qr Code Supporter ////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

// Generate QR codes for all supporters and set the array g_supporter_image_data
function generateQrCodeAllSupporters()
{
    g_supporter_image_data = [];

    var season_str = '2021-2022';

    var canvas_context = getCanvasContextQrCode();

    for (var index_name=0; index_name < g_supporter_names.length; index_name++)
    {
        var name_str = g_supporter_names[index_name];

        var image_data = generateQrCodeOneSupporter(name_str, season_str);

        g_supporter_image_data[index_name] = image_data;
    }

    // Test
    canvas_context.putImageData(g_supporter_image_data[4], 0, 0);

} // generateQrCodeAllSupporters

// Generate QR code for one supporter and set canvas
function generateQrCodeOneSupporter(i_name_str, i_season_str)
{
    var qr_text = i_name_str + ' ' + i_season_str;

    g_object_generate_qr_code.set
    (
        {
            foreground: 'black',
            size: 84,
            value: qr_text
        }

    );

    var canvas_context = getCanvasContextQrCode();

    var image_data = canvas_context.getImageData(0, 0, 84, 84);

    return image_data;

} // generateQrCodeOneSupporter

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// End Generate Qr Code Supporter //////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// Start Init QR Code Generator ////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

// Create the instance of class QRious and set global parameter g_object_generate_qr_code
function initQrCodeGenerator()
{
    g_object_generate_qr_code = new QRious
    (
        {
            element: getElementCanvasQrCode(),
            size: 84,
            value: 'https://studytonight.com'
        }
    );
} // initQrCodeGenerator

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// End Init QR Code Generator //////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// Start Hide And Display Functions ////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

// Hide the QR code image used for the generation of the codes
function hideQrCodeImage()
{
    var el_qr_code = getElementCanvasQrCode();

    el_qr_code.style.display = 'none';

} // hideQrCodeImage

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// End Hide And Display Functions //////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// Start Get Html Elements, Identities And Classes /////////////////
///////////////////////////////////////////////////////////////////////////////////////////

// Get the canvas context for the QR code
function getCanvasContextQrCode()
{
    return getElementCanvasQrCode().getContext("2d");

} // getCanvasContextQrCode

// Get the canvas element for the QR code
function getElementCanvasQrCode()
{
    return document.getElementById(getIdCanvasQrCode());

} // getElementCanvasQrCode

// Returns the identity of the canvas element for the QR code
function getIdCanvasQrCode()
{
    return 'id_canvas_qr_code';

} // getIdCanvasQrCode

// Returns the class of the canvas element for the QR code
function getClassCanvasQrCode()
{
    return 'cl_canvas_qr_code';

} // getClassCanvasQrCode

// Returns the class of the div canvas element for the QR code
function getClassDivCanvasQrCode()
{
    return 'cl_div_qr_canvas';

} // getClassDivCanvasQrCode

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// End Get Html Elements, Identities And Classes ///////////////////
///////////////////////////////////////////////////////////////////////////////////////////