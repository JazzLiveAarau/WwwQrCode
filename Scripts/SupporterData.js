// File: SupporterData.js
// Date: 2022-05-05
// Author: Gunnar Lid√©n

// File content
// =============
//
// Get and set supporter data

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// Start Global Parameters /////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

// Array with all supporter names
var g_supporter_names = [];


///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// End Global Parameters ///////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// Start Event Functions ///////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// End Event Functions /////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// Start Set SupporterData Array ///////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// End Set SupporterData Array /////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// Start Class SupporterData ///////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

// Class holding data for one supporter
class SupporterData
{
    // Constructor
    constructor(i_supporter_xml, i_season_start_year, i_supporter_number)
    {
        this.m_xml = i_supporter_xml;

        this.m_season_start_year = i_season_start_year;

        this.m_supporter_number = i_supporter_number;

        this.m_first_name = '';

        this.m_family_name = '';

        this.m_house_number = '';

        this.m_postal_code = '';

        this.m_domicil = '';

        this.m_email = '';

        this.m_comment = '';

        this.m_contribution = 0;

    } // constructor

    setData(i_supporter_number)
    {
        this.m_first_name = this.m_xml.getFirstName(this.m_supporter_number);

        this.m_family_name = this.m_xml.getFamilyName(this.m_supporter_number);

        this.m_house_number = this.m_xml.getHouseNumber(this.m_supporter_number);

        this.m_postal_code = this.m_xml.getPostalCode(this.m_supporter_number);

        this.m_domicil = this.m_xml.getDomicil(this.m_supporter_number);

        this.m_email = this.m_xml.getEmail(this.m_supporter_number);

        this.m_comment = this.m_xml.getComment(this.m_supporter_number);

        this.m_contribution = parseInt(this.m_xml.getContribution(this.m_supporter_number, this.m_season_start_year));

    } // setData

    getFirstName() { return this.m_first_name }

    getFamilyName() { return this.m_family_name } 

    getHouseNumber() { return this.m_house_number } 

    getPostalCode() { return this.m_postal_code }

    getDomicil() { return this.m_domicil }

    getEmail() { return this.m_email }

    getComment() { return this.m_comment }

    getContribution() { return this.m_contribution } 

} // QrSupporterData


///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// End Class SupporterData /////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// Start Test Temporary Functions //////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

// Set the array with data from the XML file Supporter.xml
function setTestArrayFromXmlObject(i_xml)
{
    QrProgress.Append('Enter setTestArrayFromXmlObject');

    g_supporter_names = [];

    var n_supporters = i_xml.getNumberOfSupporters();

    var out_index = 0;

    for (var supporter_number = 1; supporter_number <= n_supporters; supporter_number++)
    {
        var first_name = i_xml.getFirstName(supporter_number);

        var family_name = i_xml.getFamilyName(supporter_number);
    
        var contribution_int = i_xml.getContributionInt(supporter_number);

        if (contribution_int - 60 >= 0)
        {
            g_supporter_names[out_index] = first_name + ' ' + family_name;

            out_index = out_index + 1;
        }
    }

    QrProgress.Append('g_supporter_names is set (' + g_supporter_names.length.toString() + ')');
    
    QrProgress.Append('Exit setTestArrayFromXmlObject');
    
} // setTestArrayFromXmlObject


///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////// End Test Temporary Functions ////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////


